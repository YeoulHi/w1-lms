# QA-005-001: 과제 채점 및 피드백 기능 테스트

## 1. 문서 개요

- **목적**: `features/submissions`으로 구현될 과제 채점 및 재제출 요청 기능의 정합성을 검증하기 위한 QA 테스트 케이스를 정의합니다.
- **범위**: 강사(Instructor)의 채점 및 재제출 요청 기능과 관련된 프론트엔드(FE) 및 백엔드(BE)의 모든 시나리오를 포함합니다.
- **참고 문서**:
  - [기능 명세서 (spec.md)](../005/spec.md)
  - [구현 계획서 (plan.md)](../005/plan.md)

## 2. 사전 준비 사항

1.  **사용자 계정**:
    - `Instructor` 역할의 사용자 (이하 **강사 A**)
    - `Learner` 역할의 사용자 (이하 **학습자 B**)
2.  **데이터 상태**:
    - **강사 A**가 생성한 `Course-1`이 `published` 상태로 존재해야 합니다.
    - **강사 A**가 `Course-1` 내에 `Assignment-1`을 생성하고 `published` 상태로 게시해야 합니다.
    - **학습자 B**가 `Course-1`에 수강 등록(`enrolled`)되어 있어야 합니다.
    - **학습자 B**가 `Assignment-1`에 과제를 제출하여 `submissions` 레코드가 `submitted` 상태로 존재해야 합니다.

## 3. 테스트 시나리오

### A. 성공 시나리오 (Happy Path)

| ID | 시나리오 | 테스트 단계 | 예상 결과 | 결과 |
| :--- | :--- | :--- | :--- | :--- |
| A-1 | **정상 채점** | 1. **강사 A**로 로그인하여 `Assignment-1`의 제출물 목록으로 이동합니다.<br>2. **학습자 B**의 제출물을 선택합니다.<br>3. 점수(예: `95`)와 피드백(예: "Great job!")을 입력합니다.<br>4. "채점 완료" 버튼을 클릭합니다. | 1. API가 `200 OK` 응답을 반환합니다.<br>2. "채점이 완료되었습니다." 토스트 메시지가 나타납니다.<br>3. 제출물 상태가 UI 상에서 '채점 완료'로 변경되고, 점수와 피드백이 표시됩니다.<br>4. 데이터베이스에서 해당 `submissions` 레코드의 `status`가 `graded`로, `score`와 `feedback`이 입력값으로 업데이트됩니다. | |
| A-2 | **재제출 요청** | 1. **강사 A**로 로그인하여 `Assignment-1`의 제출물 목록으로 이동합니다.<br>2. **학습자 B**의 제출물을 선택합니다.<br>3. "재제출 요청" 버튼을 클릭합니다. | 1. API가 `200 OK` 응답을 반환합니다.<br>2. "재제출을 요청했습니다." 토스트 메시지가 나타납니다.<br>3. 제출물 상태가 UI 상에서 '재제출 필요'로 변경됩니다.<br>4. 데이터베이스에서 해당 `submissions` 레코드의 `status`가 `resubmission_required`로 업데이트됩니다. | |

### B. 프론트엔드 유효성 검사 (Input Validation)

| ID | 시나리오 | 테스트 단계 | 예상 결과 | 결과 |
| :--- | :--- | :--- | :--- | :--- |
| B-1 | **점수 범위 초과** | 1. **강사 A**로 로그인하여 채점 UI에 진입합니다.<br>2. 점수에 `101`을 입력하고 "채점 완료"를 클릭합니다. | 1. "점수는 0과 100 사이여야 합니다."와 같은 프론트엔드 유효성 검사 오류 메시지가 표시됩니다.<br>2. API 요청이 발생하지 않습니다. | |
| B-2 | **점수 범위 미만** | 1. **강사 A**로 로그인하여 채점 UI에 진입합니다.<br>2. 점수에 `-1`을 입력하고 "채점 완료"를 클릭합니다. | 1. "점수는 0과 100 사이여야 합니다."와 같은 프론트엔드 유효성 검사 오류 메시지가 표시됩니다.<br>2. API 요청이 발생하지 않습니다. | |
| B-3 | **피드백 미입력** | 1. **강사 A**로 로그인하여 채점 UI에 진입합니다.<br>2. 점수만 입력하고 피드백 필드를 비워둔 채 "채점 완료"를 클릭합니다. | 1. "피드백은 필수입니다."와 같은 프론트엔드 유효성 검사 오류 메시지가 표시됩니다.<br>2. API 요청이 발생하지 않습니다. | |

### C. 백엔드 유효성 검사 및 권한 (Error Cases)

| ID | 시나리오 | 테스트 단계 | 예상 결과 | 결과 |
| :--- | :--- | :--- | :--- | :--- |
| C-1 | **권한 없는 사용자** | 1. **학습자 B**로 로그인합니다.<br>2. 개발자 도구나 API 클라이언트를 사용하여 `PATCH /api/submissions/{id}` 채점 API를 직접 호출합니다. | 1. API가 `403 Forbidden` 또는 `401 Unauthorized` 오류를 반환합니다. | |
| C-2 | **소유하지 않은 과제** | 1. 다른 강사(강사 C)가 생성한 과제의 제출물 ID를 확보합니다.<br>2. **강사 A**로 로그인하여 API 클라이언트로 해당 제출물에 대한 채점을 시도합니다. | 1. API가 `403 Forbidden` 오류와 "권한이 없습니다." 메시지를 반환합니다. | |
| C-3 | **중복 채점 시도** | 1. `A-1` 시나리오를 통해 채점을 완료하여 `graded` 상태로 만듭니다.<br>2. 동일한 제출물에 대해 다시 채점 API를 호출합니다. | 1. API가 `409 Conflict` 오류와 "이미 채점이 완료된 과제입니다." 메시지를 반환합니다. | |

### D. 결과 확인 (End-to-End Verification)

| ID | 시나리오 | 테스트 단계 | 예상 결과 | 결과 |
| :--- | :--- | :--- | :--- | :--- |
| D-1 | **학습자 뷰 확인** | 1. `A-1` 시나리오로 채점을 완료합니다.<br>2. **학습자 B**로 로그인하여 `Assignment-1` 상세 페이지 또는 성적 페이지로 이동합니다. | 1. 제출물 상태가 '채점 완료'로 표시됩니다.<br>2. **강사 A**가 입력한 점수(`95`)와 피드백("Great job!")이 정확히 표시됩니다. | |
| D-2 | **재제출 기능 확인** | 1. `A-2` 시나리오로 재제출을 요청합니다.<br>2. **학습자 B**로 로그인하여 `Assignment-1` 상세 페이지로 이동합니다. | 1. 제출물 상태가 '재제출 필요'로 표시됩니다.<br>2. 과제 제출 UI(텍스트, 링크 입력)가 다시 활성화되어 제출이 가능한 상태가 됩니다. | |
