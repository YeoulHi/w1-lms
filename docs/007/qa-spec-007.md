# QA Spec: 7. 성적 및 피드백 열람 (Learner)

## 1. 개요

이 문서는 학습자(Learner)가 자신의 코스별 성적 및 피드백을 확인하는 기능이 올바르게 구현되었는지 검증하기 위한 QA 명세입니다. 아래 시나리오에 따라 기능을 테스트하고 결과를 확인합니다.

## 2. 사전 준비

원활한 테스트를 위해 아래와 같은 데이터가 준비되어 있어야 합니다.

- [ ] **계정**
  - `instructor@test.com` (강사)
  - `learner@test.com` (학습자)
- [ ] **데이터**
  - 강사 계정으로 로그인하여 코스("테스트 코스")를 생성합니다.
  - 학습자 계정으로 로그인하여 "테스트 코스"에 수강 신청합니다.
  - 강사 계정으로 "테스트 코스"에 최소 2개의 과제("과제 1", "과제 2")를 생성합니다.
  - 학습자 계정으로 "과제 1"과 "과제 2"를 모두 제출합니다.
  - 강사 계정으로 "과제 1"에 대해서만 채점을 완료합니다. (예: 점수 `90`, 피드백 `"잘했습니다."`) "과제 2"는 채점하지 않은 상태로 둡니다.

## 3. 테스트 시나리오

### 시나리오 1: 채점/미채점 과제가 모두 있는 경우 (Happy Path)

- **목표**: 학습자가 자신의 성적 현황을 정상적으로 조회할 수 있는지 확인합니다.
- **실행**:
  1. `learner@test.com` 계정으로 로그인합니다.
  2. 브라우저 주소창에 위에서 생성한 코스의 성적 페이지 URL(`http://localhost:3000/courses/{courseId}/grades`)로 직접 이동합니다.
- **예상 결과**:
  - [ ] `Gradebook` 테이블이 화면에 표시됩니다.
  - [ ] "과제 1" 행에는 `채점 완료` 뱃지, 점수 `90`, 피드백 `"잘했습니다."`가 표시됩니다.
  - [ ] "과제 2" 행에는 `채점 중` 뱃지, 점수 `-`, 피드백 `-`가 표시됩니다.

### 시나리오 2: 수강하지 않는 코스에 접근하는 경우

- **목표**: 수강하지 않는 코스의 성적에 접근할 수 없는지 확인합니다.
- **준비**: 학습자가 수강신청하지 않은 다른 코스의 `courseId`를 준비합니다.
- **실행**:
  1. `learner@test.com` 계정으로 로그인합니다.
  2. 준비된 `courseId`를 사용하여 성적 페이지 URL로 직접 이동합니다.
- **예상 결과**:
  - [ ] API 요청이 실패하고, 화면에 `"성적을 불러오지 못했습니다."` 라는 오류 메시지가 표시됩니다.

### 시나리오 3: 코스에 과제가 없는 경우

- **목표**: 과제가 없는 코스에서 빈 상태가 올바르게 표시되는지 확인합니다.
- **준비**: 강사가 과제를 하나도 생성하지 않은 코스를 준비하고, 학습자가 수강 신청합니다.
- **실행**:
  1. `learner@test.com` 계정으로 로그인합니다.
  2. 해당 코스의 성적 페이지 URL로 직접 이동합니다.
- **예상 결과**:
  - [ ] 화면에 `"표시할 성적이 없습니다."` 라는 메시지가 표시됩니다.

---

## 4. 참고: 완료된 구현 내역

- 성적 API가 active 상태 수강 여부를 선 검증하고 공개/마감 과제만 조회한 뒤 제출 정보(점수·피드백·상태)를 매핑해 Zod로 검증하도록 정리했습니다.
- 코스 라우터에 성적 조회 엔드포인트를 등록하고 인증 헤더/파라미터 검증을 표준화했습니다.
- 프런트엔드에서 공용 DTO를 재수출하고, React Query 훅이 Supabase access_token을 붙여 호출하며 오류 메시지를 정규화하도록 구성했습니다.
- 테이블 UI 컴포넌트와 성적/피드백 테이블을 추가해 로딩·에러·빈 상태까지 모두 처리합니다.
- 동적 코스 경로(/courses/[id]/grades)에서 파라미터를 안전하게 추출해 Gradebook을 렌더링합니다.
