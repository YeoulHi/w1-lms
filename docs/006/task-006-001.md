# Task: 강사(Instructor) 회원가입 후 대시보드 404 오류 수정

## 1. 문제 상황

- **Actor**: 강사 (Instructor)
- **Trigger**: 강사 역할로 회원가입을 완료합니다.
- **Issue**: 회원가입 직후 `/instructor/dashboard` 경로로 리디렉션되지만, 해당 페이지가 존재하지 않아 404 (Not Found) 오류가 발생합니다.

## 2. 원인 분석

- `src/app/(protected)` 경로 그룹 내의 파일 구조를 확인한 결과, 강사 대시보드에 해당하는 페이지는 `src/app/(protected)/dashboard/page.tsx`에 위치해 있습니다.
- Next.js App Router의 라우팅 규칙에 따라, 이 페이지의 정확한 URL 경로는 `/dashboard` 입니다.
- 현재 회원가입 로직이 강사를 잘못된 경로인 `/instructor/dashboard`로 보내고 있어 문제가 발생합니다.

## 3. 해결 방안

회원가입 성공 후, 사용자의 역할이 '강사(instructor)'일 경우, 올바른 경로인 `/dashboard`로 리디렉션되도록 수정해야 합니다.

### A. 리디렉션 로직 수정

- **파일 위치**: `src/features/auth/hooks/useSignUp.ts`
- **수정 대상**: `useSignUp` 훅의 `onSuccess` 콜백 함수 내부
- **수정 내용**:
    - 현재 `router.push('/instructor/dashboard')` 로 하드코딩된 부분을 조건부 리디렉션으로 변경합니다.
    - 회원가입 시 반환되는 사용자 정보 또는 `form.getValues('role')`을 사용하여 역할을 확인합니다.
    - 역할이 `instructor`이면 `/dashboard`로, 그 외(e.g., `learner`)는 기존 경로(`/`) 또는 다른 적절한 경로로 리디렉션하도록 수정합니다.

```typescript
// src/features/auth/hooks/useSignUp.ts (수정 예시)

// ... (imports)

export const useSignUp = (onSuccessCallback?: () => void) => {
  const router = useRouter();
  const { toast } = useToast();

  return useMutation({
    mutationFn: signUp,
    onSuccess: (data, variables) => {
      toast({
        title: '성공',
        description: '회원가입이 완료되었습니다.',
      });
      onSuccessCallback?.();

      // 수정될 부분: 역할에 따른 리디렉션
      if (variables.role === 'instructor') {
        router.push('/dashboard'); // '/instructor/dashboard' -> '/dashboard'
      } else {
        router.push('/'); // 학습자의 경우 기본 페이지로 이동
      }
    },
    onError: (error) => {
      // ... (기존 에러 처리)
    },
  });
};
```

### B. (선택) 상수 사용

- 코드의 일관성과 유지보수성을 위해, 리디렉션 경로를 `@/constants/auth.ts` 파일에 상수로 정의하고 가져와 사용하는 것을 권장합니다.

```typescript
// src/constants/auth.ts (추가 예시)
export const INSTRUCTOR_DASHBOARD_PATH = '/dashboard';
export const LEARNER_DASHBOARD_PATH = '/'; // 또는 '/dashboard' 등
```

## 4. QA 시나리오

- `[성공]` 강사로 회원가입 시, 404 오류 없이 `/dashboard` 경로의 페이지가 정상적으로 표시되는가?
- `[성공]` 학습자(Learner)로 회원가입 시, 기존과 동일하게 홈('/') 또는 지정된 다른 경로로 정상적으로 리디렉션되는가?
- `[확인]` 코드 수정 후 `npx tsc --noEmit`을 실행하여 타입 에러가 발생하지 않는가?

## 5. 참고 구현 (Reference Implementation)

코드베이스 전체를 분석한 결과, 이 작업을 위해 **"복사해서 붙여넣을 만한 완벽한 역할 기반 리디렉션의 모범 사례"는 존재하지 않습니다.**

대신, 다음과 같은 **핵심 패턴**을 참고하여 구현하는 것이 가장 좋습니다.

### 핵심 패턴: `useCurrentUser` 훅으로 역할 데이터를 확인하고 조건부 로직 수행

1.  **중앙화된 역할 기반 라우팅의 부재**
    - `middleware.ts`와 `src/app/(protected)/layout.tsx`는 사용자의 **로그인 여부(인증)**만 확인할 뿐, **역할(권한)**에 따른 분기 처리를 하지 않습니다.
    - 따라서 역할 기반 로직을 참고할 중앙화된 장소는 없습니다.

2.  **역할 데이터는 `useCurrentUser` 훅으로 조회**
    - 클라이언트 사이드에서 로그인된 사용자의 정보(역할 포함)를 가져오는 표준 방법은 `useCurrentUser` 훅을 사용하는 것입니다.
    - `src/app/(protected)/layout.tsx`는 이 훅을 사용하여 로그인 상태를 확인하는 좋은 예시입니다.

3.  **`useSignUp` 훅의 로직이 이미 올바른 방향**
    - 아이러니하게도, 우리가 수정하려는 `useSignUp.ts` 파일이 역할에 따라 리디렉션을 분기하는 유일한 예시입니다.
    - 비록 경로가 `/instructor/dashboard`로 잘못되었지만, `onSuccess` 콜백에서 역할(`variables.role`)을 확인하여 `router.push`를 호출하는 현재의 접근 방식은 올바릅니다.

### 결론

- 새로운 로직을 찾거나 만들 필요 없이, **기존 `useSignUp` 훅의 잘못된 URL(`/instructor/dashboard`)만 올바른 경로(`/dashboard`)로 수정**하면 됩니다.
- 이 방식이 프로젝트의 "최소 기능 구현" 및 "가장 낮은 복잡도" 원칙에 가장 부합합니다.